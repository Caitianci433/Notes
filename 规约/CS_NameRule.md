## 概要

------

### 前提事項

- 本システムのコーディングに用いる C# のバージョンは、8.0 とする
- 本書は、Microsoft より発行されている「C# のコーディング規則 (C# プログラミング ガイド)」をベースにカスタマイズした規約となる。

### 本規約制定の目的

本規定は、以下の効果を狙い制定する

- コードの見た目を統一し、コードを読むときに、レイアウトではなく内容に重点が置かれる
- 経験に基づく推測が働くことにより、より迅速なコード理解に寄与する
- コードのコピー、変更、および保守を容易にする
- 本規約により、C# のコーディングのベストプラクティスの理解を促進する

### 重要度合の説明

- 本規約にでは、必須のものと推奨ものを以下のように定義することとする。

|      | 対応必須有無 | 説明                                                         |
| :--- | :----------- | :----------------------------------------------------------- |
| ★1   | 必須         | 静的ツールにて対応                                           |
| ★2   | 必須         | レビューアによるレビューにて対応                             |
| ◎    | 推奨事項     | ガイドライン的な扱い。全て満たしているかのチェックは行わない） |
| なし | 任意         | ガイドライン的な扱い。全て満たしているかのチェックは行わない） |

## 構成要素の命名規則

------

### 全構成要素共通

- [★2]コメントの英字表記

  - コメント以外は半⾓英数のみで記述し、英単語を使⽤する (※ローマ字綴りでの表記は禁⽌)

- [★2]単語の省略

  - 単語の省略形は原則使用せず、対象の識別が明確になるように命名する

  ```cs
  例) Msg     → NG
      Message → OK
      ※ただし、スコープの小さい ローカル変数 などでの使用、
      　用語辞書などに準ずる使用は可とする
      　使用した場合、表記揺れを発生させないように留意する
      　　例) window, win, windows  → 混在はNG
  ```

- [★2]抽象的表現

  - 抽象的な表現の命名はNGとする

  ```cs
  例) temp, work → NG
  ```

#### 補足：記述形式の説明

- 大文字・小文字の使い分けについては、以下の2種の記述形式を構成要素により使い分ける

|       記述形式       | 説明                                           | 記述例                        |
| :------------------: | :--------------------------------------------- | :---------------------------- |
| Pascal(パスカル)形式 | 単語の先頭の各文字を大文字にして連結           | PascalCaseName, LogInUserName |
| Camel(キャメル)形式  | 最初の単語以外の先頭の各文字を大文字にして連結 | camelCaseName, logInUserName  |

### 名前空間

- [★2]名前空間の命名

  - 名前空間の定義に用いる名称は、Pascal形式 で記述し、. 演算子で区切り、概念の大きなものより階層構造で記述する

- [★2]ディレクトリ構造

  - 名前空間の定義は、所属する構成要素のファイルが置かれるディレクトリ名(ディレクト構造)に原則 合致させる

  ```cs
  namespace Assembly名.サービス名.レイヤ名
  {
      // クラスの定義
  }
  ```

### クラス

- [★2]命名の形式
  - クラスの名称は、Pascal形式 で記述し、役割を表す名称とする
- [★2]構造
  - 基本的には 1クラス 1ファイルで記述し、ファイル名とクラス名を合わせる
- 命名
  - 処理中心のクラスには接尾辞として-erを付け、派生クラスの名称は、基本クラス(継承元)の名前を含める

|                           |                                          |
| :------------------------ | :--------------------------------------- |
| クラス                    | String, Window, Task                     |
| 処理中心のクラス          | StringBuilder                            |
| Exceptionを継承したクラス | ArgumentException, ArgumentNullException |

#### クラスメンバー(変数/プロパティ/メソッド等)の命名規則

- [★1]各命名形式
  - クラスを構成するクラスメンバーの名称は、それぞれ以下の形式とする

| 重要度                           | メンバー    | 命名規則                                           | 備考 |
| :------------------------------- | :---------- | :------------------------------------------------- | :--- |
| 定数                             | Pascal形式  |                                                    |      |
| 列挙型                           | Pascal形式  |                                                    |      |
| 静的フィールド                   | Pascal形式  | static修飾子が付与されたもの                       |      |
| フィールド                       | Camel形式+α | Camel形式に加えて、Prefixとして先頭に「_」をつける |      |
| プロパティ                       | Pascal形式  |                                                    |      |
| メソッド                         | Pascal形式  |                                                    |      |
| コンストラクター                 | Pascal形式  | クラス名と同様                                     |      |
| ファイナライザー(デストラクター) | Pascal形式  | 接頭辞 ’~’ + クラス名                              |      |
| インナークラス                   | Pascal形式  |                                                    |      |
| ローカル変数／引数／ループ変数   | Camel形式   |                                                    |      |

- [★２]メソッド命名形式

  - メソッドは、処理内容に準じた動詞を含ませ、原則、**動詞＋名詞**の形式ものとする。(最終ページの参考を参照)

- [★２]論理値(True/False)の命名

  - 論理値を返却するメソッド,プロパティ,変数の名称には、**Is-, Has-, Can-** などの接頭辞を付ける

- [★２]NG名称

  - bool Check〇〇()やbool ××Checker()など、True,Falseがどちらを表すのかわからない、命名はしない。

- [★２]NG名称

  - 変数/名に型を現す命名(ハンガリアン記法)や特定の接尾辞の付加は、保守性低下/冗長になるケースが多いため、使用しない。

  ```cs
  例) intMoney, xxxxFlag  → NG
  ```

- コレクションや配列を格納するメンバー変数/プロパティ、コレクションや配列を格納する戻り値があるメソッド名には、**s** を付け複数形にする

  ```cs
  例) List<File> file,  byte[] byte   → NG
      List<File> files, byte[] bytes  → OK
  
      List<File> LoadFile();   → NG
      List<File> LoadFiles();  → OK
  ```

- 拡張メソッドのクラスは、**Extensions**を語尾につける。

### 列挙対/構造体/インターフェイス/デリゲート

- [★２]列挙対/構造体/インターフェイス/デリゲートの名称は、クラスと同様に Pascal形式 で記述する

### その他

- [★２]インタフェース名
  - インタフェースは、Prefixとして先頭に「I」をつける。
- [★２]抽象クラス名
  - 抽象クラスは、Suffixとして再度に「Abstract」をつける。
- [◎]基底クラス名
  - 基底クラスは、Prefixとして再度に「Base」をつける。

## レイアウト規則

------

C# のソースファイルに対するレイアウトの基本的なルールは 以下とする

- [★２]1行の記載

  - 1つの行には 1つの 宣言 または ステートメント のみを記述する

  ```cs
  //OK
  var firstName = "太郎"; 
  var lastname = "みずほ";
  
  //Ng
  var firstName = "太郎"; var lastname = "みずほ";
  ```

- [◎]改行位置

  - 1行が長くなる場合、'.'(ピリオド)の前、または、演算子の後で改行する

  ```cs
  // ピリオドの前で改行
  var currentPerformanceCounterCategory = new System
      .Diagnostics.PerformanceCounterCategory();
  
  // 演算子の後で改行
  if ((data == null) ||
      (data == DBNull.Value) ||
     (String.IsNullOrEmpty(data.ToString())))
  {
     // 処理
  }
  ```

- [◎]改行位置

  - 引数が多く、1行が長くなる場合は、'('(括弧)や','(カンマ)の後で改行する

  > ※引数の数が多くなる場合は、オブジェクト化もしくは、Builderパターンの適用を検討する
  > 　メソッドチェーンを記述する場合はピリオドを前置とする

  ```cs
    // 括弧,カンマの後で改行
    var ipAddr = String.Format(
        "{0}.{1}.{2}.{3}",
        0x7F, 0x00, 0x00, 0x01);
  
    // メソッドチェーンの改行
    var connStr = new StringBuilder()
        .AppendFormat($"Server={localhost};")
        .AppendFormat($"Database={master};")
        .AppendFormat($"User Id={sa};")
        .AppendFormat($"Password={sa};")
        .ToString();
  ```

  > Builderパターン
  >
  > https://www.techscore.com/tech/DesignPattern/Builder.html/

- [★1]インデント

  - インデントは 空白4文字、タブを用いた場合、ファイル保存時に変換する。(タブでは保存しない)

  > Editerの設定をTab→半角空白4文字に書ておく。

- [★1]インデント

  - 継続行にもインデントを設定する

- [◎]空白

  - メソッド/プロパティ定義等、各定義の間に少なくとも 1行の空白行を追加する

- [★1]括弧

  - 式に句を作成するときは括弧を使用し、開始と終了の括弧はインデントをそろえる

  ```cs
  namespace ソリューション名.アプリケーションドメイン名.サービス名.レイヤ名
  {
      /// <summary>
      /// サンプルクラスの定義
      /// </summary>
      public class SampleClass
      {
          private ILogger<Sampe> logger;
  
          /// <summary>
          /// サンプルメソッドの定義
          /// </summary>
          /// <param name="parameter">パラメータの説明</param>
          public void SampleMethod(String parameter)
          {
  
          }
      }
  }
  ```

- [◎]1メソッドの行数は**目安30行以下**とする(※止むを得ない場合を除く)

  > 30行以上となる場合は、設計を見直しを検討する。

## コメント規則

C# のソースファイルに記するコメントに関する基本的なルールは 以下とする

- [◎]コメント位置

  - コメントは、コード行の末尾ではなく別の行に記述する

  ```cs
  var a = 0; // ダメなコメントのパターンです。 → NG
  
  // コメントは別の行に記述します。 → OK
  var a = 0;
  ```

- [★2]冗長コメントの不要

  - 冗長なコメントは記述しない。コメントがないと設計/実装の意図が捉えずらい場合のみ簡潔に記載する

    - 実装を見てわかる部分は不要
    - 実装から読み取れない場合のみ記載(基本的には、実装の見直しを検討すること)

    ```cs
    //NGサンプル(よくある冗長コメント)
    //ファイルを読込む ←見ればわかるため、このコメントは不要。
    using(var stream = new MemoryStream(file)){
      //行数分ループを回し、処理をする。 ←見ればわかるため、このコメントは不要。
      foreach(var a in lines){
    
      }
      //結果を返却する ←見ればわかるため、このコメントは不要。
      return result;
    }
    ```

- [◎]コメント デリミター

  - コメント デリミター '//' とコメント テキストの間に空白を 1つ挿入する

- [★1]public系のNDoc

  - private以外のクラスメンバー(メソッド、プロパティ等)には、NDoc形式のコメントを記載する。

- [◎]private系のNDoc

  - private系のNDocについては、あると望ましい保守性向上につながる場合のみとし、必須ではない。

- [★1]NDoc全体

  - 空のNDocは、書かない。

|  メンバー  |         記載項目         | 記載例                                                       |
| :--------: | :----------------------: | :----------------------------------------------------------- |
|   クラス   |       サマリ 例外        | /// `<summary>` /// ここにはクラスの要約を書きます。 /// `</summary>` /// `<remark>` /// ここにはクラスの詳細説明を書きます。 /// `</remark>` /// `<exception cref="System.Exception">` /// ここには例外の説明を書きます。 /// `</exception>` |
| フィールド |          サマリ          | /// `<summary>` /// ここにはフィールドの説明を書きます。 /// `</summary>` |
| プロパティ |        サマリ 値         | /// `<summary>` /// ここにはプロパティの説明を書きます。 /// `</summary>` /// `<value>`ここには値の説明を書きます。`</value>` |
|  メソッド  | サマリ パラメータ 戻り値 | /// `<summary>` /// ここにはメソッドの要約を書きます。 /// `</summary>` /// `<param name="val">`ここにはパラメータの要約を書きます。`</param>` /// `<returns>`ここには戻り値の説明を書きます。`</returns>` |

## 命名参考リスト

引用元：https://qiita.com/KeithYokoma/items/2193cf79ba76563e3db6

### 真偽値を返すメソッド

| 場所   | 単語   | 意味                                                         | 例            |
| :----- | :----- | :----------------------------------------------------------- | :------------ |
| Prefix | Is     | (オブジェクトが)期待する状態になっているかどうか             | IsChecked     |
| Prefix | Can    | (オブジェクトが)期待する動作をできるかどうか                 | CanRemove     |
| Prefix | Should | (呼び出し側が)ある命令を実行したほうがよいかどうか           | ShouldMigrate |
| Prefix | Has    | (オブジェクトが)期待するデータ・プロパティを持っているかどうか | HasObservers  |
| Prefix | Needs  | (呼び出し側が)ある命令を実行する必要があるかどうか           | NeedsMigrate  |

### 必要に応じてしか実行されない処理をするメソッド

| 場所   | 単語      | 意味                                                         | 例                     |
| :----- | :-------- | :----------------------------------------------------------- | :--------------------- |
| Suffix | IfNeeded  | 必要なら実行し、必要なければ何もしない                       | DrawIfNeeded           |
| Prefix | might     | 同上                                                         | MightCreate            |
| Prefix | Try       | 実行を試み、失敗した場合は例外を飛ばすか、エラーコードを返す | TryCreate              |
| Suffix | OrDefault | 実行を試み、失敗した場合は既定値を返す                       | GetOrDefault           |
| Suffix | OrElse    | 実行を試み、失敗した場合は引数で指定した値を返す             | GetOrElse              |
| Prefix | Force     | 強制的に実行を試みる。エラーは例外ないし返り値で表す         | ForceCreate, ForceStop |

### 非同期処理に関連するメソッド

| 場所           | 単語         | 意味                                         | 例                    |
| :------------- | :----------- | :------------------------------------------- | :-------------------- |
| Prefix         | Blocking     | スレッドをブロックするメソッド               | BlockingGetUser       |
| Suffix         | InBackground | バックグラウンドスレッドで実行されるメソッド | DoInBackground        |
| Suffix         | Async        | 非同期メソッド                               | SendAsync             |
| Prefix or Stem | Schedule     | ジョブやタスクをキューに積む                 | Schedule, ScheduleJob |
| Prefix or Stem | Post         | 同上                                         | PostJob               |
| Prefix or Stem | Execute      | 非同期処理を実行する                         | Execute, ExecuteTask  |
| Prefix or Stem | Start        | 同上                                         | Start, StartJob       |
| Prefix or Stem | Cancel       | 非同期処理の実行を止める                     | Cancel, CancelJob     |
| Prefix or Stem | Stop         | 同上                                         | Stop, StopJob         |

### コレクションの操作に関するメソッド

| 単語     | 意味                                                 | 例         |
| :------- | :--------------------------------------------------- | :--------- |
| Contains | 指定したものと同じオブジェクトを持っているかどうか   | Contains   |
| Add      | 追加する                                             | AddJob     |
| Pppend   | 同上                                                 | AppendJob  |
| Insert   | n番目に追加する                                      | InsertJob  |
| Put      | キーに対応する要素を追加する                         | PutJob     |
| Remove   | 要素を削除する                                       | RemoveJob  |
| Enqueue  | 行列末尾に追加する                                   | EnqueueJob |
| Dequeue  | 行列先頭を取り出して取り除く                         | DequeueJob |
| Push     | スタックの先頭に追加する                             | PushJob    |
| Pop      | スタックの先頭を取り出して取り除く                   | PopJob     |
| Peek     | スタックの先頭を取り出す(スタックからは取り除かない) | PeekJob    |
| Find     | 条件にあうものを探す                                 | FindById   |

### 状態に関するメソッド

| 単語     | 意味                                                         | 例             |
| :------- | :----------------------------------------------------------- | :------------- |
| Ensure   | 期待する状態かどうかをチェックし、そうでない場合は例外を投げるかエラーコードを返す | EnsureCapacity |
| Validate | 正しい状態かどうかをチェックし、そうでない場合は例外を投げるかエラーコードを返す | ValidateInputs |

### オブジェクトのライフサイクルを扱うメソッド

| 単語       | 意味                                   | 例         |
| :--------- | :------------------------------------- | :--------- |
| Initialize | 初期化。遅延初期化のメソッドとしても。 | Initialize |
| Abandon    | デストラクタの代替                     | Abandon    |
| Destroy    | 同上                                   | Destroy    |
| Dispose    | 同上                                   | Dispose    |

### データに関するメソッド

| 単語   | 意味                                                       | 例            |
| :----- | :--------------------------------------------------------- | :------------ |
| Create | 新しく作る                                                 | CreateAccount |
| New    | 新しく作る                                                 | NewAccount    |
| From   | 既存のものから新しく作る、あるいは別のデータから新しく作る | FromConfig    |
| To     | 変換する                                                   | ToString      |
| Update | 既存のものを書き換える                                     | UpdateAccount |
| Load   | 読み込む                                                   | LoadAccount   |
| Fetch  | (リモートから)読み込む                                     | FetchAccount  |
| Delete | 削除する                                                   | DeleteAccount |
| Remove | 削除する                                                   | RemoveAccount |
| Save   | 保存する                                                   | SaveAccount   |
| Store  | 保存する                                                   | StoreAccount  |
| Commit | 保存する                                                   | CommitChange  |
| Apply  | 保存・適用する                                             | ApplyChange   |
| Clear  | データを消す、あるいは初期状態に戻す                       | ClearAll      |
| Reset  | データを消す、あるいは初期状態に戻す                       | ResetAll      |